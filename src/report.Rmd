---
title: "Report"
author: "Amy Goldlist, Maud Boucherit, Tyler Roberts"
date: "April 16, 2018"
output:
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


```

```{r loading, include = FALSE}
## load libraries
library(tidyverse)
library(scales)
library(cowplot)  ### maybe try a different one?
 
## load in data
dat <- read.csv("../results/clean_data.csv")


#dat$desert_island <- factor(dat$desert_island, levels=rev(levels(dat$desert_island)))

## I'm manually making Star Trek be number 2.
dat$desert_island <- factor(dat$desert_island, levels=c("neither", "Star Wars", "Star Trek"))
```



## Introduction

The series "Star Wars" and "Star Trek" attract a lot of comparison, possibly because they both start with the word "Star".  In our personal experience, we feel that the geekier a person identifies as, the more strongly they feel about this question.  In order to explore this in a more rigorous fashion, we created a survey to gather data about the subject, hen analysed the data.  After looking at the data, we explored a model that we like to call the "rare disease" model, in which we posit that while preferring Star Trek is in the minority across all categories, being geekier increases the odds of choosing Star Trek over other alternatives.  We borrowed the methodology from statistical methods developed for studying relatively rare diseases, hence the name.  In this vein, we will use mosaic plots to explore the data, and log odds ratios as an analytical tool.

## Methodology

We collected data using an [online survey](https://goo.gl/forms/Jb3pCN6GVhqziVvt1) asking users about their familiarity and knowledge of both series, as well as some basic demographic information, and how geeky they consider themselves.  The online nature was chosen for convenience, and as a criteria of the course this project is for.  We hoped that in our analysis we would be able to compensate from the no-random method of choosing respondants.

### Survey Study Design

The main question we were concerned with was whether a person's choice of Star Wars or Star Trek is correlated with their self-reported geekiness.  In order to tease out whether the choice had to do with how familiar they were with the series, we also asked respondents to rank their knowledge and familiarity about the series on a traditional likert scale from 1 to 5.  In order to differentiate if the 5s were truly experts, we had a separate skill testing question that was only triggered if respondents answered 5 to the knowledge questions.  The main responce question asks respondants what series they would choose, if stuck on a desert island.  We call this their "desert island choice".

Our main explanatory variable is "Geekiness", which we measured on a 5 point likert scale.  We decided to omit a definition of geekiness, understanding that people's intrinsic understnading of the term is inherantly tied in with how they rank themselves.  This was a deliberate choice, and therefore we will refer to the "self-reported geekiness" level, as we have no objective way to truly assess what level people are.

In order to adjust for possible confounders introduced by the nature of the survey, we asked basic demographic questions, such as age, gender, employment sector, continent and whether or not they were an MDS student.  We chose to leave the age in 10 year ranges, in order to protect the anonymity of our respondents.  We deliberately asked for gender identification, and gave many options, in order not to conform to putdated gender norms.  We did however, merge our results into 'male', 'female', and 'other' for better analysis.  For location, we chose to ask about continent they most identified with, in order to allow people who have lived in multiple locations to dedide which was most important to their identity,

Finally, we used humour in our questions in order to keep respondents engaged and forwarding the survey.  We understand that this is not everybod's preference, but we ended up with a significantly larger sample than we had planned for (around 180 respondants vs an etimated 45), which helped gather more data, particulary in different age groups and continents.    


### Data Collection Methods

We collected data by distributing an online survey.  We distributed the survey through three main channels:

- 1 All UBC MDS students completed the survey during designated class time

- 2 We sent the survey to all [**Maud put program name in here**].  Since this program is in France, we hoped to get a more multicultural sample.

- 3 We posted it on Facebook and let Facebook's algorithm share as it would.  In order to get it to the top of Facebook feeds, we attempted to game their algorithm using the following text: "She said yes! It's twins!!! Here's one little trick, Congrats!! (now that I've hopefully gamed the algorithm enough to get to the top of your feed). Feel like filling out a survey? I promise not to steal your data, and you'd be having fun and helping me with a project."  

It should be noted that this method of sampling falls squarely under the header of "convenience sampling", and our sample is skewed towards the tech community.  

### Aspects of Ethics

After reading the UBC ethics code, we feel that our survey has no sensitive information, and we will not ask any personally identifying questions.  To this end, for age we will have the respondent choose from 10 year ranges.  Because of this, we feel confident enough to use Google forms as a vehicle.  As per UBC policy, we will have a paragraph (copied verbatim from the UBC page for legal reasons) informing the respondent that the information will be stored in a US server subject to homeland security, and have them click to acknowledge this:

> "This online survey company is hosted by a web survey company located in the USA (Google) and  as such is subject to U.S. laws, in particular, the US Patriot Act which allows authorities access to the records of internet service providers. If you choose to participate in the survey, you understand that your responses to the survey questions will be stored and accessed in the USA. The security and privacy policy for Google can be found at the following link: https://policies.google.com/"


### The Survey

Below is the complete survey, including the images we included:

#### Self-Identified Geekiness
- How would you rate your degree of geekiness?
    - From (1) not geeky at all to (5) super geeky

#### Star Wars-related
![](../images/sw_logo.png)
- How would you rate your degree of fandom?
    - From (1) I hate it! to (5) I even love the prequels!
- How would you rate your degree of knowledge about the Star Wars universe?
    - From (1) no knowledge at all to (5) expert knowledge
    - If rated 5: People are redirected to a hardcore question about Star Wars:
        > Who first uttered the line "It's a trap!" and in what film?

#### Star Trek-related
![](../images/st_logo.png)


- How would you rate your degree of fandom?
    - From (1) I hate it! to (5) I even love Wrath of Khan!
- How would you rate your degree of knowledge about the Star Trek universe?
    - From (1) no knowledge at all to (5) expert knowledge
    - If rated 5: People are redirected to a hardcore question about Star Trek:
        > According to Klingon mythology, what is the place where all life began?

#### Star Wars Vs. Star Trek
![](../images/sw_vs_st.png)

- Overall, are you more familiar with Star Wars or Star Trek universe?
    - Answers are: Star Wars, Star Trek, Both, Neither
- You're stuck on a deserted island, with a TV and only one complete set of movies/TV episodes/books/games to entertain you for the rest of your life.  Which do you choose?
    - Answers are: Star Wars, Star Trek, Neither: I will stare at the sand for the rest of my life rather than choose a quality science fiction series to watch.

#### Confounding Variables
- What is your age?
    - Below 20, In my 20s, In my 30s, In my 40s, 50 or older
- What is your gender?
    - Female, Male, Non-binary, Prefer not to say, Other…
- Which continent would you identify yourself with?
    - North America, South America, Asia, Europe, Africa, Oceania, Antarctica
- What is the main sector of your job/education background?
    - Tech, Finance/Economics/Business, A, ministration/Education, Biology/Medicine, Chemistry/Physics, Math/Statistics, Other…
- Are you currently enrolled in the MDS program at UBC?


### Analysis Methods
We decided to incorporate confounding variables gender, age, continent and sector of activity because we want to have information about who answered our survey so we can identify any possible bias in the sample.  [**Add more, probably**]

We plan to look at relationships between our response and explanatory variables and these confounding variables in order to decrease any bias. To do so, we want to stratify our survey's answers according to a propensity score. 

Methods we explored are logistic regression, both binomial, ordinal and multinomial, and propensity score matching.

**EXPAND THIS PART!!!**

## Analysis and Results 


### Exploratory Data Analysis

If you would like to see the R code to produce these plots, please see [this Rscript](../src/image_ag.R). [**If the images end up here, we can direct this to the Rmd file**]  As part of our analysis, we looked at relationships between our response and explanatory variables and various other responses.  Here are some highlights of that analysis.  All of the analysis below is based on a sample of [**174, OR MORE??**] respondents to our survey.  

#### Geekiness and Desert Island Choice


The focus of our analysis is the effect of geekiness on the variable we have called "Desert Island Choice".  

```{r desert_island-geekiness, echo = FALSE}

  
  ## changed the y label to proportion

  p2 <- dat %>% 
    ggplot(aes(fill = desert_island, x = geeky)) +
    geom_density(n=5) +
    facet_wrap(~desert_island) +
    theme_bw() + 
    scale_fill_manual(values = c("firebrick3", "darkgoldenrod2", "dodgerblue3")) +
    guides(fill = FALSE) +
    labs(title = "Desert Island Picks by Self-Identified Geekiness", y="Proportion", x="Self-Identified Geekiness")

p2
```

```{r}
### option 2

#Or is a Bar plot of geekiness by desert_island better?  TA seems to think so

dat %>% 
    ggplot(aes(fill = desert_island, x = geeky)) +
    geom_bar()+
    facet_wrap(~desert_island) +
    theme_bw() + 
    scale_fill_manual(values = c("firebrick3", "darkgoldenrod2", "dodgerblue3")) +
    guides(fill = FALSE) +
    labs(title = "Desert Island Picks by Self-Identified Geekiness", y="Count", x="Self-Identified Geekiness")

```



These plots show the distribution of self-identified geekiness faceted by the respondent's choice in series to have on a desert island.

Unsurprisingly, those who chose neither, who would prefer to stare out to sea or at patterns in the sand, generally rated themselves lower on the geekiness scale; with nearly 40% of such respondents rating themselves 1 or 2 out of 5, although the mode here appears to be a 3 as well. It is surprising that at least one person who rated themselves  5/5 in geekiness chose to watch neither of the series if stuck for eternity on a desert island.

Over 50% of those who chose Star Wars rated themselves a 3/5 on the geekiness scale although the distribution appears to be left skewed, with more people in this group rating themselves 4 than those rating themselves 2.

The mode for the Star Trek distribution was 4, unlike the other two groups. This might suggest that on average, people who prefer Star Trek are geekier, or at least consider themselves to be geeks more often. One way that we could formalize this more would be to measure the kurtosis in these distributions.

This is where we will focus our attention in our analysis, in explaining the differing shapes of these distributions.

```{r}
### try number 3:
dat %>% 
    #filter(continent %in% c("North America", "Europe", "Asia")) %>% 
    ggplot(aes(fill = desert_island, x = geeky)) +
      theme_bw() +
      geom_bar(position = "fill") +
      scale_fill_manual(values = c("firebrick3", "darkgoldenrod2", "dodgerblue3")) +
      coord_flip() + 
      #scale_fill_brewer(palette = "Dark2") +
      guides(fill=guide_legend(title="Desert Island Choice")) +
      labs(title="Desert Island Proportion by Geekiness", x="Proportion Selected", y="Desert Island Choice")

```
As we can see by the above mosaic plot, the proportion of those choosing Star Trek appears to be increasing as geekiness increases.

```{r}
### but what if we get rid of the neithers?

dat %>% 
    filter(desert_island != "neither") %>% 
    ggplot(aes(fill = desert_island, x = geeky)) +
      theme_bw() +
      geom_bar(position = "fill") +
      scale_fill_manual(values = c("darkgoldenrod2", "dodgerblue3")) +
      coord_flip() + 
      #scale_fill_brewer(palette = "Dark2") +
      guides(fill=guide_legend(title="Continent")) +
      labs(title="Desert Island Proportion by Geekiness", x="Proportion Selected", y="Desert Island Choice")

```

**Notes to Maud and Tyler: Is this really increasing?  I'm not sure we can say more than it's less popular amond the 1s....**

Though theses plots don't seem to show a clear trend, we posit that that this is due to the confounding variables, and the uneven sample sizes.  


#### Age and Desert Island Choice

An important confounding variable is age.  As we can see from the mosaic plot below, there is a clear effect.

```{r Age-desert-island, echo = FALSE}
 p3 <- subset(dat, !is.na(age)) %>% 
    ggplot(aes(x = desert_island, fill = factor(age, level = rev(levels(factor(age)))))) + 
      geom_bar(position = "fill", colour = "black") +
      theme_bw() +
      #scale_y_continuous("Age", minor_breaks = NULL,  
       #                  breaks = c(0, 0.036, 0.735, 0.908, 0.977), 
        #                 labels = c(0, 20, 30, 40, 50)) +
      coord_flip() + 
      scale_fill_brewer(labels=c("Less than 20", "20 to 30", "30 to 40", "40 to 50", "Greater than 50"), palette = "Dark2") +
      guides(fill=guide_legend(title="Age Group")) +
      labs(title="Desert Island Picks by Age", x="Desert Island Choice", y="Proportion Selected")

###  This may not be the correct graph, but here goes:

age_geekiness <- subset(dat, !is.na(age)) %>% 
    ggplot(aes(x = geeky, fill = factor(age, level = rev(levels(factor(age)))))) + 
      geom_bar(position = "fill", colour = "black") +
      theme_bw() +
      #scale_y_continuous("Age", minor_breaks = NULL,  
       #                  breaks = c(0, 0.036, 0.735, 0.908, 0.977), 
        #                 labels = c(0, 20, 30, 40, 50)) +
      coord_flip() + 
      scale_fill_brewer(labels=c("Less than 20", "20 to 30", "30 to 40", "40 to 50", "Greater than 50"), palette = "Dark2") +
      guides(fill=guide_legend(title="Age Group")) +
      labs(title="Geekiness Picks by Age", x="Geekiness", y="Proportion Selected")

legend <- get_legend(p3)

### THis is an experiment!
cowplot::plot_grid(p3+ theme(legend.position="none"), 
                   age_geekiness+ theme(legend.position="none"),
                   rel_widths = c(1,1,.3),
                   #align = "h",
                   ncol = 3,
                   legend)

### THis is an experiment!
cowplot::plot_grid(p3+ theme(legend.position="none"), 
                   age_geekiness,
                   rel_widths = c(2,3),
                   #align = "h",
                   ncol = 3)


```



The above figure breaks down each age group's choice of series. Since the 20-30 age group was by far the largest group of respondents to this survey, they dominate each of the three choices. That being said, they seem to make up fewer of those who would choose Star Trek, decreasing by roughly the same amount that the 30-40 group increased for this choice.

While the "Less than 20" group is one of the smallest, they have a larger than usual proportion among those who chose neither.

Finally, *nobody* among the 40-50 group chose to stare at the sand.

Given these results, we feel that it is prudent to include age as a confounding variable in our analysis.


#### Continent and Desert Island Choice

```{r}
  # Response by continent
  p4 <- dat %>% 
    filter(continent %in% c("North America", "Europe", "Asia")) %>% 
    ggplot(aes(x = desert_island, fill = continent)) +
      theme_bw() +
      geom_bar(position = "fill", colour = "black") +
      #scale_y_continuous("Continent (most identified)", minor_breaks = NULL,  
       #                  breaks = c(0.125, 0.58, 0.95), 
        #                 labels = c("North America", "Europe", "Asia")) +
      coord_flip() + 
      scale_fill_brewer(palette = "Dark2") +
      guides(fill=guide_legend(title="Continent")) +
      labs(title="Desert Island Proportion by Continent", x="Desert Island Choice", y="Proportion Selected")

p4
```


The above plot breaks down each continent's choice of series if they were stuck on a desert island.  Most people who chose Star Trek as their preferred series were located in North America, while Star Wars fans are highly concentrated in Europe relative to the other regions. Asia had the highest proportion of people who would prefer to stare at the sand for all eternity. 

When looking at these results, it is important to keep in mind that this plot does not capture the differences in total number of people who selected each series, so while most of the people who chose Star Trek identify as North Americans, the absolute number of these people is still lower than those from North America who chose Star Wars, and so on.

Given this effect, continent is another confounder that will be included in our analysis.


#### Familiarity and Desert Island Choice

```{r desert_island-familiarity, echo = FALSE}

 # Bar plot of desert_island by familiarity
p1 <- dat %>% 
    ggplot(aes(x = desert_island, fill = familiar)) +
    geom_bar(colour = "black") +
    theme_bw() +
    scale_fill_manual(values = c("darkolivegreen3", "dodgerblue3", "darkgoldenrod2", "firebrick3")) +
    guides(fill=guide_legend(title="Most Familiar With")) +
    labs(title = "Desert Island Picks by Familiarity", y="Count", x="Desert Island Choice")

p1
```



It makes intuitive sense that a person's familiarity with various series would influence their choice of series, and indeed it seems to be so.

An interesting result from the above plot is that very few people who are most familiar with Star Trek chose Star Wars as their desert island series, whereas a large number of those who were more familiar with Star Wars chose Star Trek. However, those who reported being equally familiar with both seemed evenly split between the two groups. 

Those who were not familiar with either series were mostly the ones who preferred to stare at the sand for eternity, and there were *zero* of those who were most familiar with Star Trek in that category.  Familiarity is another confounder which we choose to include in our analysis.



## discussion of  results

## discussion of  survey/study design

In our original survey, we did not leave a space for "the arts" under employment sector.  As a result, we had a lot of write in "other" categories, thus making analysis difficult. We also chose to narrow our focus to Star Trek vs Star Wars, and not include other science fiction series, such as "Doctor Who".  This did annoy some of our respondents, who did not want to choose.  As well, some respondents felt that we should have dealt with the "geek vs nerd" dichotomy, which is not something we have an opinion on, but apparently people do.